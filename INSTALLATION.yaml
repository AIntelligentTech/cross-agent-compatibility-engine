---
manifest_version: 2.0.0
package:
  name: "@aintelligenttech/cace-cli"
  version: "2.5.0"
  type: "npm"
  description: "Cross-Agent Compatibility Engine - Convert and validate AI agent components between multiple platforms"

  # Runtime metadata
  runtime:
    node_version: ">=18.0.0"
    package_manager: "bun"
    package_manager_version: ">=1.0.0"

  # Repository metadata
  repository:
    type: "git"
    url: "https://github.com/AIntelligentTech/cross-agent-compatibility-engine"
    directory: "."

  # Publishing metadata
  publishing:
    registry: "https://registry.npmjs.org"
    scope: "@aintelligenttech"
    access: "public"
    tag: "latest"

# Installation steps
installation:
  # Pre-installation validation
  pre_install:
    - name: "Verify Node.js version"
      type: command
      command: "node --version"
      validation:
        type: semver
        constraint: ">=18.0.0"

    - name: "Verify Bun availability"
      type: command
      command: "bun --version"
      validation:
        type: semver
        constraint: ">=1.0.0"

  # Main installation
  install:
    - name: "Install dependencies"
      type: command
      command: "bun install"
      description: "Install package dependencies via Bun"

    - name: "Build TypeScript"
      type: command
      command: "bun run build"
      description: "Compile TypeScript to JavaScript"

  # Post-installation setup
  post_install:
    - name: "Verify CLI binary"
      type: command
      command: "test -f ./dist/cli/index.js && echo 'CLI ready'"
      description: "Ensure CLI is built and executable"

    - name: "Link global command"
      type: command
      command: "bun link"
      description: "Make 'cace' command globally available"
      optional: true

# Configuration
configuration:
  optional:
    - name: GITHUB_TOKEN
      description: "GitHub personal access token with repo and packages scopes"
      type: secret
      validation:
        type: pattern
        pattern: "^gh[ps]_[a-zA-Z0-9]{36,}$"

    - name: NPM_TOKEN
      description: "NPM authentication token for publishing"
      type: secret
      validation:
        type: pattern
        pattern: "^npm_[a-zA-Z0-9]{36}$"

# Testing
testing:
  unit:
    - name: "Run unit tests"
      command: "bun test"
      description: "Execute Bun tests"

  lint:
    - name: "Lint code"
      command: "bun run lint"
      description: "Run ESLint"

# Health checks
health_checks:
  - name: "CLI availability"
    type: command
    command: "cace --help || ./dist/cli/index.js --help"
    interval: manual

  - name: "TypeScript type check"
    type: command
    command: "bun run typecheck"
    interval: manual

# Metadata
metadata:
  maintainers:
    - name: "Tony Deverill"
      email: "tony.deverill@aintelligenttech.com"
      github: "tonydeverill"

  tags:
    - ai-agents
    - cli
    - typescript
    - compatibility
    - conversion

  documentation:
    - url: "https://github.com/AIntelligentTech/cross-agent-compatibility-engine/blob/main/README.md"
      type: readme

  changelog_url: "https://github.com/AIntelligentTech/cross-agent-compatibility-engine/blob/main/CHANGELOG.md"
  license: MIT
